{% extends "index.html" %}

{% block title %}리뷰 목록 | 이화마켓{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="css/review.css">
{% endblock %}

{% block section %}
  <main class="main-content">
    <div class="card review-page">
      <h2 class="page-title">상품 후기 / 전체 조회</h2>
      <p class="review-count">총 <strong>{{total}}개</strong> 리뷰</p>

      <!-- 필터 버튼 -->
      <div class="filter-buttons">
        <button class="btn-pill btn-pill-active">최신순</button>
        <button class="btn-pill btn-pill-inactive">평점순</button>
      </div>

      <!-- 리뷰 카드 목록 -->
      <div class="review-grid">
        <!-- 리뷰 카드  -->
        {% for key, value in datas %}

      <div class="review-card" onclick="location.href='/review-detail/{{ key }}'" style="cursor:pointer;">
          <div class="review-img-wrap">
             {% if value.img_path and value.img_path != "" %}
               <img src="/{{ value.img_path }}" class="review-img" alt="리뷰 이미지">
             {% else %}
               <img src="{{ url_for('static', filename='uploads/default_review.png') }}" class="review-img" alt="기본 이미지">
             {% endif %}
          </div>
          <div class="review-user">
            <div class="user-avatar"></div>
            <div class="user-meta">
              <p class="username">{{ value.writer_id | default('') }}</p>
              <p class="date">{{ format_time_ago(value.created_at) if value.created_at else '' }}</p>
            </div>
          </div>
          <div class="stars">
             {% set rating = (value.rate | default(0) | float) | int %}

            {% for i in range(rating) %}
              ★
            {% endfor %}
            {% for i in range(5 - rating) %}
              ☆
            {% endfor %}
          </div>
          <p class="rating">{{ value.rate if value.rate else '5.0' }}</p>
          <p class="content">{{ value.content }}</p>
          <p class="product-name">{{ value.item_name }}</p>
        </div>
        {% endfor %}

        
      </div>

      <!-- 페이지네이션 -->
      <div class="pagination">
        <ul class="pagination-list">
          {% for i in range(page_count) %}
            {% if i == page %}
              <li><a href="{{ url_for('view_review',page=i) }}" class="active">{{ i+1 }}</a></li>
            {% else %}
              <li><a href="{{ url_for('view_review',page=i) }}">{{ i+1 }}</a></li>
            {% endif %}
          {% endfor %}
        </ul>
      </div>
    </div>
  </main>
{% endblock %}
