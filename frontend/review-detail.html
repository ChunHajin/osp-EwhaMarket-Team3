{% extends "index.html" %}

{% block title %}리뷰 상세 | 이화마켓{% endblock %}

{% block styles %}
    <link rel="stylesheet" href="/css/review-detail.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
{% endblock %}

{% block section %}
    <main class="main-content">
        <div class="review-detail-container">
            <h1 class="page-title">리뷰 상세</h1>

            <div class="review-header">
                <h2 class="review-title">{{ review_data.title if review_data.title else '제목 없음' }}</h2>
                <span class="review-author">작성자 {{ review_data.writer_id if review_data.writer_id else '작성자 정보 없음' }}</span>
            </div>

            <div class="card review-card">
                <div class="review-content-body">
                    <div class="review-photo-wrapper">
                        {% if review_data.img_path and review_data.img_path != "" %}
                        <img src="{{ url_for('static', filename=review_data.img_path) }}" alt="{{ review_data.item_name }} 리뷰 사진" class="review-photo">
                        {% else %}
                        <img src="{{ url_for('static', filename='uploads/default_review.png') }}" alt="기본 이미지" class="review-photo">
                        {% endif %}
                    </div>
                    
                    <div class="review-text-wrapper">
                        <div class="review-rating-group">
                            {% set rating_value = review_data.rate | default(0.0) | float %}
                            {% set filled_stars_count = rating_value | int %}

                            <div class="star-rating" data-rating="{{ rating_value | round(1) }}">
                                {% for i in range(filled_stars_count) %}
                                <i class="fas fa-star star"></i>
                                {% endfor %}

                                {% for i in range(5 - filled_stars_count) %}
                                <i class="far fa-star star"></i>
                                {% endfor %}
                            </div>
                            <span class="rating-number">{{ rating_value | round(1) }}</span>
                        </div>
                        <div class="review-text-content"></div>
                            <p class="review-text">
                                {{ review_data.content | nl2br }}
                            </p>
  
                        </div>
                    </div>
                    <span class="review-time">{{ format_time_ago(review_data.created_at) if review_data.created_at }}</span>
                </div>
            </div>
            
        </div>
    </main>
{% endblock %}